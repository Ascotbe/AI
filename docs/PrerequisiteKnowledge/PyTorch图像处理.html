
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PyTorch图像处理 &#8212; AI学习笔记</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'PrerequisiteKnowledge/PyTorch图像处理';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="函数详解" href="../FunctionDetails/index.html" />
    <link rel="prev" title="关于tensor中的is_leaf" href="%E5%85%B3%E4%BA%8Etensor%E4%B8%AD%E7%9A%84is_leaf.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="AI学习笔记 - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="AI学习笔记 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to AI Notes
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">前置知识</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="%E5%BC%A0%E9%87%8F.html">张量</a></li>
<li class="toctree-l2"><a class="reference internal" href="%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6.html">广播机制</a></li>

<li class="toctree-l2"><a class="reference internal" href="%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E8%BD%B4axis%E5%92%8Cdim.html">深度学习中的轴/axis/dim全解</a></li>
<li class="toctree-l2"><a class="reference internal" href="%E8%87%AA%E5%8A%A8%E6%B1%82%E5%AF%BC.html">自动求导</a></li>
<li class="toctree-l2"><a class="reference internal" href="%E5%85%B3%E4%BA%8Etensor%E4%B8%AD%E7%9A%84is_leaf.html">关于tensor中的is_leaf</a></li>

<li class="toctree-l2 current active"><a class="current reference internal" href="#">PyTorch图像处理</a></li>




</ul><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../FunctionDetails/index.html">函数详解</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../FunctionDetails/torch.argmax.html">Torch Argmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../FunctionDetails/torch.matmul.html">Torch Matmul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../FunctionDetails/torch.normal.html">Torch Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../FunctionDetails/torch.zeros.html">Torch Zeros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../FunctionDetails/nn.Linear.html">nn.Linear的基本定义</a></li>

<li class="toctree-l2"><a class="reference internal" href="../FunctionDetails/nn.ReLU.html">nn.ReLU</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../LinearNeuralNetwork/index.html">线性神经网络</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../LinearNeuralNetwork/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92.html">线性回归</a></li>







<li class="toctree-l2"><a class="reference internal" href="../LinearNeuralNetwork/Softmax%E5%9B%9E%E5%BD%92%E5%8E%9F%E7%90%86.html">Softmax 回归原理</a></li>


<li class="toctree-l2"><a class="reference internal" href="../LinearNeuralNetwork/%E4%BA%A4%E5%8F%89%E7%86%B5%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0.html">交叉熵损失函数原理详解</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LinearNeuralNetwork/Softmax%E5%9B%9E%E5%BD%92%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0.html">Softmax回归代码实现</a></li>








</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../MultilayerPerceptrons/index.html">多层感知机</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../MultilayerPerceptrons/%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA.html">多层感知机的简洁实现</a></li>
</ul><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/ascotbe/AI" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/PrerequisiteKnowledge/PyTorch图像处理.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PyTorch图像处理</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PyTorch图像处理</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">导入所需的库</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">加载图片</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pil">PIL库</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">pytorch中提供的图像加载方法</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#transforms">transforms</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compose">Compose</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">自定义图像变换</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pytorchapi">pytorch中开箱即用的图像变换API</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api">通用型图像变换API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#centercrop-size">CenterCrop(size)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resize-size">Resize(size)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pad-padding-fill-0-padding-mode-constant">Pad(padding, fill=0, padding_mode=’constant’)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colorjitter-brightness-0-contrast-0-saturation-0-hue-0">ColorJitter(brightness=0, contrast=0, saturation=0, hue=0)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomrotation-degrees-interpolation">RandomRotation(degrees[, interpolation, …])</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussianblur-kernel-size-sigma">GaussianBlur(kernel_size[, sigma])</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fivecrop-size-tencrop-size-vertical-flip-false">FiveCrop(size)与 TenCrop(size, vertical_flip=False)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grayscale-num-output-channels-1-randomgrayscale-p-0-1">Grayscale(num_output_channels=1) RandomGrayscale(p=0.1)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomsolarize-threshold-p-0-5">RandomSolarize(threshold, p=0.5)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomaffine-degrees-translate-none-scale-none-shear-none-resample-false-fillcolor-0">RandomAffine(degrees, translate=None, scale=None, shear=None, resample=False, fillcolor=0)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomcrop-size-padding-none-pad-if-needed-false-fill-0-padding-mode-constant">RandomCrop(size, padding=None, pad_if_needed=False, fill=0, padding_mode=’constant’)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomhorizontalflip-p-0-5-randomverticalflip-p-0-5">RandomHorizontalFlip(p=0.5)与RandomVerticalFlip(p=0.5)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomperspective-distortion-scale-0-5-p-0-5-interpolation-3-fill-0">RandomPerspective(distortion_scale=0.5, p=0.5, interpolation=3, fill=0)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomequalize-p-0-5">RandomEqualize(p=0.5)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomapply-p-0-5">RandomApply(p=0.5)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pil-imageapi">专用于PIL.Image的图像变换API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomchoice-transforms-p">RandomChoice(transforms[, p])</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomorder-transforms-p">RandomOrder(transforms[, p])</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#torch-tensorapi">专用于torch.*Tensor的图像变换API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lineartransformation-transformation-matrix">LinearTransformation(transformation_matrix, …)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-mean-std-inplace-false">Normalize(mean, std, inplace=False)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomerasing-p-0-5-scale-0-02-0-33-ratio-0-3-3-3">RandomErasing(p=0.5, scale=(0.02, 0.33), ratio=(0.3, 3.3)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">RandomErasing(p=0.5, scale=(0.02, 0.33), ratio=(0.3, 3.3)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">转换类型的图像变换API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topilimage-mode">ToPILImage([mode])</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#totensor">ToTensor()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#piltotensor">PILToTensor()</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pytorch">
<h1>PyTorch图像处理<a class="headerlink" href="#pytorch" title="Link to this heading">#</a></h1>
<p>计算机视觉任务中，对图像的变换（Image Transform）往往是必不可少的操作，例如在迁移学习中，需要对图像尺寸进行变换以使用预训练网络的输入层，又如对数据进行增强以丰富训练数据。</p>
<p>作为深度学习领域的主流框架，pytorch中提供了丰富的图像变换API。本文将对pytorch中torchvision.transforms提供的丰富多样的图像变换API进行整理介绍。</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>导入所需的库<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<p>为方便下文展示各种图像变换API的效果，我们借助matplotlib定义一个名为<code class="docutils literal notranslate"><span class="pre">show_image</span></code>函数来展示图片，如下所示：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>
<span class="kn">from</span> <span class="nn">torchvision.io</span> <span class="kn">import</span> <span class="n">read_image</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SimHei&#39;</span><span class="p">]</span>  <span class="c1"># 中文字体支持</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_image</span><span class="p">(</span><span class="n">img_lst</span><span class="p">,</span> <span class="o">**</span><span class="n">imshow_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    img_lst: 保存图像和标题的list，形如：[(image1, title1),(image2, title2)]。image可以使Pillow.Image对象，也可以是torch.Tensor。</span>
<span class="sd">    imshow_kwargs: 需要传递给plt.imshow的参数</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">img_lst</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">img_lst</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">img_lst</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>  <span class="c1"># 如果是torch.Tensor类型，就必须转换成Pillow.Image类型，才能进行展示</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ToPILImage</span><span class="p">()(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="o">**</span><span class="n">imshow_kwargs</span><span class="p">)</span>
        <span class="c1"># axs[0, i].set(xticklabels=[], yticklabels=[], xticks=[], yticks=[])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id2">
<h1>加载图片<a class="headerlink" href="#id2" title="Link to this heading">#</a></h1>
<section id="pil">
<h2>PIL库<a class="headerlink" href="#pil" title="Link to this heading">#</a></h2>
<p>对于存储在磁盘中的图片文件，使用Pillow库提供的Image类对象进行打开是一种十分常用的方法，如果你还没有安装，你可以通过以下命令方便下文进行：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>Pillow
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</div>
</div>
<p>我们通过Pillow中提供的方法，打开一张图片，并通过<code class="docutils literal notranslate"><span class="pre">show_image()</span></code>方法进行展示，下文中各种图像变换，我们都将以此图片为例，进行演示：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">),</span> <span class="s1">&#39;原始图片&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span><span class="n">raw_img</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>findfont: Generic family &#39;sans-serif&#39; not found because none of the following families were found: SimHei
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>findfont: Generic family &#39;sans-serif&#39; not found because none of the following families were found: SimHei
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 21407 (\N{CJK UNIFIED IDEOGRAPH-539F}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 22987 (\N{CJK UNIFIED IDEOGRAPH-59CB}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 22270 (\N{CJK UNIFIED IDEOGRAPH-56FE}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 29255 (\N{CJK UNIFIED IDEOGRAPH-7247}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/09409825a3fce39542d68c6ba200fe69c05de74722cbe0889274d04bf994382f.png" src="../_images/09409825a3fce39542d68c6ba200fe69c05de74722cbe0889274d04bf994382f.png" />
</div>
</div>
</section>
<section id="id3">
<h2>pytorch中提供的图像加载方法<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>pytorch的torchvision.io模块本身也提供有加载图像数据的方法：read_image。该方法直接将图片加载为Tensor类型数据。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torchvision.io</span> <span class="kn">import</span> <span class="n">read_image</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img2</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([3, 338, 328])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">raw_img2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Tensor
</pre></div>
</div>
</div>
</div>
<p>我们也通过之前定义的<code class="docutils literal notranslate"><span class="pre">show_image()</span></code>方法进行展示，注意，<code class="docutils literal notranslate"><span class="pre">show_image()</span></code>方法之所以能展示Tensor类型数据为图像，是因为<code class="docutils literal notranslate"><span class="pre">show_image()</span></code>方法内将Tensor转为PIL图像了。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_image</span><span class="p">([(</span><span class="n">raw_img2</span><span class="p">,</span> <span class="s1">&#39;read_image()&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/82022cbca218e9f194f45fe7658416d97629669be2ee3c2b2ad32a624f1041ec.png" src="../_images/82022cbca218e9f194f45fe7658416d97629669be2ee3c2b2ad32a624f1041ec.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="transforms">
<h1>transforms<a class="headerlink" href="#transforms" title="Link to this heading">#</a></h1>
<section id="compose">
<h2>Compose<a class="headerlink" href="#compose" title="Link to this heading">#</a></h2>
<p>在介绍transforms前，有必要先说说Compose。</p>
<p>我们做图像变换时，一般都不会单独使用一个图像变换API，而是顺序使用多个API。对于多个API，transforms模块中提供Compose类，对多个API进行打包。Compose关键代码如下所示：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Compose</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transforms</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span> <span class="o">=</span> <span class="n">transforms</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span>
</pre></div>
</div>
</div>
</div>
<p>可见，在实例化Compose时，我们需要将用到的的API，按顺序存入列表（也可以是其他可迭代对象）中，传递给Compose。Compose内部机制，将会首先将图像传给第一个API，然后将经变换后的图像依次往后需API传递。如下所示，我们使用Compose对多个API进行组合：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
   <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="mi">350</span><span class="p">),</span>  <span class="c1"># 变换尺寸</span>
   <span class="n">transforms</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span>  <span class="c1"># 裁切中心180像素</span>
   <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>  <span class="c1"># 转为Tensor类型</span>
   <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>  <span class="c1"># 标准化</span>
       <span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">],</span>
       <span class="n">std</span><span class="o">=</span><span class="p">[</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">]</span>
   <span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">preprocess</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([3, 300, 300])
</pre></div>
</div>
</div>
</div>
<p>我们对边变换前后的图像：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_image</span><span class="p">([(</span><span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span><span class="p">),(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;变换后&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 20687 (\N{CJK UNIFIED IDEOGRAPH-50CF}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 21464 (\N{CJK UNIFIED IDEOGRAPH-53D8}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 25442 (\N{CJK UNIFIED IDEOGRAPH-6362}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 21518 (\N{CJK UNIFIED IDEOGRAPH-540E}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/e3f98501289ac508e1bbcbf48fb177727806f4297437fc3acd9b2c101f7f7a41.png" src="../_images/e3f98501289ac508e1bbcbf48fb177727806f4297437fc3acd9b2c101f7f7a41.png" />
</div>
</div>
</section>
<section id="id4">
<h2>自定义图像变换<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>transforms是pytorch中torchvision包提供的图像变换模块，提供了各式各样的图像变换API，这些API都是通过可调用对象，可以是函数、也可以是类，如果是类，就必须实现<code class="docutils literal notranslate"><span class="pre">__call__()</span></code>方法，至于返回的数据类型，并没有严格限制，只要后续的图像变换API能够接收就好，但就一般而言，最后一个API的都是Tensor类型数据。所以，如果自定义图像变换API，遵循这些规则去定义可调用对象就好。</p>
<p>最简单的，我们使用lambda定义可调用对象：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_2_plus_1</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_2_plus_1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>当然，这并没有什么意义，只是实现将一个数字进行平方再加1的变换，这里只是演示函数方式实现变换器。接下来，我们试试类方式对图像进行变换，例如图像旋转：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RandomRotation</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tran_img</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">RandomRotation</span><span class="p">(</span><span class="mi">60</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_image</span><span class="p">([(</span><span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span><span class="p">),(</span><span class="n">tran_img</span><span class="p">,</span> <span class="s1">&#39;旋转变换后&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 26059 (\N{CJK UNIFIED IDEOGRAPH-65CB}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 36716 (\N{CJK UNIFIED IDEOGRAPH-8F6C}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/6626453638e69cb363d3e68bcbee489e7de3be945c8deca7d43f9cc2ff365fd5.png" src="../_images/6626453638e69cb363d3e68bcbee489e7de3be945c8deca7d43f9cc2ff365fd5.png" />
</div>
</div>
<p>在transforms模块中，pytorch对于多数变换都同时提供有类方式和函数方式的实现，但相较于函数，我更加推荐使用类的方式去实现变换，因为这种方式能够在实例化对象时，通过传递参数实现更加个性化的定制，例如进行尺寸变换，可以在构造方法中指定变换尺寸，这是函数方式无法做到的。函数方式更多是用在定义图像变换类使用使用，另外在功能固定、单一，使用函数方式实现也是不错的选择。</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pytorchapi">
<h1>pytorch中开箱即用的图像变换API<a class="headerlink" href="#pytorchapi" title="Link to this heading">#</a></h1>
<p>内存中的图像数据一般分为两种，一种是PIL的Image对象，一种是torch.Tensor(更严谨的说，应该是torch.*Tensor，因为也可以是Tensor的子类)，不要杠，我这里说的是建模过程中的图片形式，Python当然也可以用其他库来打开图片。相对应的，pytorch中的图像变换API也分为针对PIL.Image对象的API和针对Tensor数据的API以及能同时用于两种图像形式的API（姑且将这类API称为通用型图像变换API）。</p>
<p><strong>注意，即使是通用型API，也可能存在API内某些参数或参数值只适用于Tensor或PIL.Image</strong></p>
<p>我们先整理通用型的API。</p>
<section id="api">
<h2>通用型图像变换API<a class="headerlink" href="#api" title="Link to this heading">#</a></h2>
<section id="centercrop-size">
<h3>CenterCrop(size)<a class="headerlink" href="#centercrop-size" title="Link to this heading">#</a></h3>
<p>CenterCrop的作用是从图像的中心位置裁剪指定大小的图像。例如一些神经网络的输入图像大小为300×300，而我们上述展示的原始图像的大小为448×596，此时就需要对训练图像进行裁剪。</p>
<p>CenterCrop只有一个参数：</p>
<ul class="simple">
<li><p>size：裁切保留中央多少个像素
示例代码及结果如下：</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([3, 338, 328])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">raw_img2</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="n">tran_img1</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="n">tran_img2</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">raw_img2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PIL.Image类型数据裁切后输出类型为：</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">tran_img1</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;torch.Tensor类型数据裁切后输出类型为：</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">tran_img2</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span><span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">tran_img1</span><span class="p">,</span> <span class="s1">&#39;PIL.Image&#39;</span><span class="p">),</span>   <span class="c1"># 对PIL.Image类型图片进行裁切</span>
    <span class="p">(</span><span class="n">tran_img2</span><span class="p">,</span> <span class="s1">&#39;torch.Tensor&#39;</span><span class="p">)</span>  <span class="c1"># 对torch.Tensor类型图片进行裁切</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PIL.Image类型数据裁切后输出类型为：&lt;class &#39;PIL.Image.Image&#39;&gt;
torch.Tensor类型数据裁切后输出类型为：&lt;class &#39;torch.Tensor&#39;&gt;
</pre></div>
</div>
<img alt="../_images/61b5124b8cecb59aaab7fb40ee6865937e695734d0404da55801e7ff19004b3c.png" src="../_images/61b5124b8cecb59aaab7fb40ee6865937e695734d0404da55801e7ff19004b3c.png" />
</div>
</div>
<p>上述示例中，对PIL.Image类型和torch.Tensor类型数据进行了裁切，证明了CenterCrop这类通用型API并不会改变数据类型，输入什么类型的图像，输出还是什么类型的图像，另外从图像展示结果上看，对两种类型的图像变换的效果是一样的。</p>
</section>
<section id="resize-size">
<h3>Resize(size)<a class="headerlink" href="#resize-size" title="Link to this heading">#</a></h3>
<p>按给定尺寸对图像进行缩放，Resize主要参数size可以为int型，此时，原始图像短边将缩放至size像素，长边将缩放至：size×长边÷短边 。以上述原始图片为例，假设输入size=300，原始图像短边高是448像素，长边宽是596像素，所以缩放后，长边宽为：300×596÷448=399像素；当size为序列时，size=(h, w)，原始图像将高和宽分别缩放至h和w。除了size参数外，Resize还有其他参数，可以参考<a class="reference external" href="https://pytorch.org/vision/stable/generated/torchvision.transforms.functional.resize.html#torchvision.transforms.functional.resize">官方文档</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">transform1</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">transform2</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
<span class="n">tran_img1</span> <span class="o">=</span> <span class="n">transform1</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="n">tran_img2</span> <span class="o">=</span> <span class="n">transform2</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;size=300，缩放后图像宽高为：</span><span class="si">{</span><span class="n">tran_img1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;size=(300, 300)，缩放后图像宽高为：</span><span class="si">{</span><span class="n">tran_img2</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span><span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">tran_img1</span><span class="p">,</span> <span class="s1">&#39;size=300&#39;</span><span class="p">),</span>   <span class="c1"># 对PIL.Image类型图片进行裁切</span>
    <span class="p">(</span><span class="n">tran_img2</span><span class="p">,</span> <span class="s1">&#39;size=(300, 300)&#39;</span><span class="p">)</span>  <span class="c1"># 对torch.Tensor类型图片进行裁切</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ascotbe/anaconda3/lib/python3.10/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size=300，缩放后图像宽高为：torch.Size([3, 309, 300])
size=(300, 300)，缩放后图像宽高为：torch.Size([3, 300, 300])
</pre></div>
</div>
<img alt="../_images/1aec27c574f799992758063dff764db289e627df9f90c0fcc2989ec4dae00c8a.png" src="../_images/1aec27c574f799992758063dff764db289e627df9f90c0fcc2989ec4dae00c8a.png" />
</div>
</div>
</section>
<section id="pad-padding-fill-0-padding-mode-constant">
<h3>Pad(padding, fill=0, padding_mode=’constant’)<a class="headerlink" href="#pad-padding-fill-0-padding-mode-constant" title="Link to this heading">#</a></h3>
<p>对图像边框进行填充，主要参数如下：</p>
<ul class="simple">
<li><p><strong>padding：指定填充像素</strong></p>
<ul>
<li><p>如果是整型，表示对4个边框都填充padding个像素值</p></li>
<li><p>如果是长度为2的序列，例如，padding=(5, 10)，表示对左右边框填充5个像素值，上下边框填充10个像素值。</p></li>
<li><p>如果是长度为4的序列，例如，padding=(5, 10, 15, 20)，表示对左、上、右、下分别填充5、10、15、20个像素值。</p></li>
</ul>
</li>
<li><p><strong>fill：填充的内容，默认值为0</strong>。<strong>注意，fill的值仅当padding_mode值为’constant’时有效。当输入图像为Tensor时，fill为int型才有效；当输入图像为PIL.Image时，fill既可以为int，也可以为序列</strong>。</p>
<ul>
<li><p>当file是长度为3的序列是，分别用于填充R、G、B通道。</p></li>
</ul>
</li>
<li><p><strong>padding_mode：填充模式，即以什么内容填充。默认为值’constant’</strong></p>
<ul>
<li><p>constant：常量填充，填充的内容由fill参数指定。</p></li>
<li><p>edge：用原始图像的最后一个像素值填充。</p></li>
<li><p>reflect：在边缘上不重复最后一个值的情况下，使用图像反射进行填充。例如，图像某一行像素为[1，2，3，4]，左右两边充填两个像素，因为不重复边界像素，左侧的像素值1和右侧的像素值4不进行反射，左侧就法则2和3，发射后成了3和2，填充到图像左侧，右侧反射2和3，反射后成了3和2，填充到图像右侧，最终这一行像素值变成[3，2，1，2，4，3，2]。</p></li>
<li><p>symmetric：就是reflect方式填充，只不过重复边界像素值。[1，2，3，4]使用这种方式填充后为[2, 1, 1, 2, 3, 4, 4, 3]。</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">Pad</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;padding=20, </span><span class="se">\n</span><span class="s2"> fill=0, </span><span class="se">\n</span><span class="s2"> padding_mode=&#39;constant&#39;&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">Pad</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">padding_mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;padding=20, </span><span class="se">\n</span><span class="s2"> fill=(0, 0, 255), </span><span class="se">\n</span><span class="s2"> padding_mode=&#39;constant&#39;&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">Pad</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;padding=200, </span><span class="se">\n</span><span class="s2"> padding_mode=&#39;edge&#39;&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">Pad</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="s1">&#39;reflect&#39;</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;padding=200, </span><span class="se">\n</span><span class="s2"> padding_mode=&#39;reflect&#39;&quot;</span>
    <span class="p">),</span>
    
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">Pad</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="s1">&#39;symmetric&#39;</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;padding=200, </span><span class="se">\n</span><span class="s2"> padding_mode=&#39;reflect&#39;&quot;</span>
    <span class="p">),</span>
    
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/47820b050288e64d0be40344d89815dd9040897f3d1f2795dfeefe71d034af65.png" src="../_images/47820b050288e64d0be40344d89815dd9040897f3d1f2795dfeefe71d034af65.png" />
</div>
</div>
</section>
<section id="colorjitter-brightness-0-contrast-0-saturation-0-hue-0">
<h3>ColorJitter(brightness=0, contrast=0, saturation=0, hue=0)<a class="headerlink" href="#colorjitter-brightness-0-contrast-0-saturation-0-hue-0" title="Link to this heading">#</a></h3>
<p>ColorJitter的作用是随机修改图片的亮度、对比度、饱和度、色调，常用来进行数据增强，尤其是训练图像类别不均衡或图像数量较少时。**注意，如果输入图像为PIL.Image对象，那么，如果打开模式为“1”, “I”, “F”或者图像透明，将会产生异常。**常用参数如下：</p>
<ul class="simple">
<li><p>brightness：亮度变换范围，默认值为0，即不变换亮度</p>
<ul>
<li><p>值为float时， 亮度将在[max(0, 1 - brightness), 1 + brightness] 范围变化。</p></li>
<li><p>值为(min, max)时，亮度将在[min, max]范围内变化。不能为负数。</p></li>
</ul>
</li>
<li><p>contrast：对比度，默认值为0，即不变换对比度</p>
<ul>
<li><p>值为float时， 对比度将在[max(0, 1 - brightness), 1 + brightness] 范围变化。</p></li>
<li><p>值为(min, max)时，对比度将在[min, max]范围内变化。不能为负数。</p></li>
</ul>
</li>
<li><p>saturation：饱和度，默认值为0，即不变换饱和度</p>
<ul>
<li><p>值为float时， 饱和度将在[max(0, 1 - brightness), 1 + brightness] 范围变化。</p></li>
<li><p>值为(min, max)时，饱和度将在[min, max]范围内变化。不能为负数。</p></li>
</ul>
</li>
<li><p>hue：色调，默认值为0，即不变换色调</p>
<ul>
<li><p>值为float时， 色调将在[-hue, hue] 范围变化。</p></li>
<li><p>值为(min, max)时，色调将在[min, max]范围内变化。取值建议：0&lt;=hue&lt;=0.5或-0.5&lt;=min&lt;=max&lt;=0.5。</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">ColorJitter</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;随机变换亮度</span><span class="se">\n</span><span class="s2">brightness=(1, 10)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">ColorJitter</span><span class="p">(</span><span class="n">contrast</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;随机变换对比度</span><span class="se">\n</span><span class="s2">contrast=(1, 10)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">ColorJitter</span><span class="p">(</span><span class="n">saturation</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;随机变换饱和度</span><span class="se">\n</span><span class="s2">saturation=(1, 10)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">ColorJitter</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;随机变换色调</span><span class="se">\n</span><span class="s2">hue=(0.2, 0.4)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">ColorJitter</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">contrast</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">saturation</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">hue</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;padding=20, </span><span class="se">\n</span><span class="s2"> fill=0, </span><span class="se">\n</span><span class="s2"> padding_mode=&#39;constant&#39;&quot;</span>
    <span class="p">)</span>
    
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 38543 (\N{CJK UNIFIED IDEOGRAPH-968F}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 26426 (\N{CJK UNIFIED IDEOGRAPH-673A}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 20142 (\N{CJK UNIFIED IDEOGRAPH-4EAE}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 24230 (\N{CJK UNIFIED IDEOGRAPH-5EA6}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 23545 (\N{CJK UNIFIED IDEOGRAPH-5BF9}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 27604 (\N{CJK UNIFIED IDEOGRAPH-6BD4}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 39281 (\N{CJK UNIFIED IDEOGRAPH-9971}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 21644 (\N{CJK UNIFIED IDEOGRAPH-548C}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 33394 (\N{CJK UNIFIED IDEOGRAPH-8272}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 35843 (\N{CJK UNIFIED IDEOGRAPH-8C03}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/cf4a1c603a8d3a38b62686064159e8babd56ba2fe25959b66da47e1373796427.png" src="../_images/cf4a1c603a8d3a38b62686064159e8babd56ba2fe25959b66da47e1373796427.png" />
</div>
</div>
</section>
<section id="randomrotation-degrees-interpolation">
<h3>RandomRotation(degrees[, interpolation, …])<a class="headerlink" href="#randomrotation-degrees-interpolation" title="Link to this heading">#</a></h3>
<p>指定角度范围随机旋转图像。</p>
<ul class="simple">
<li><p>degrees：旋转角度范围</p>
<ul>
<li><p>当值为(min, max)时，表示在(min, max)范围内随机选取一角度对图像进行旋转</p></li>
<li><p>当值为数值时，等同于(-degrees, +degrees)</p></li>
</ul>
</li>
<li><p>interpolation：插值方式</p></li>
<li><p>expand：是否对图像进行扩展，以展示整个旋转后图像。</p></li>
<li><p>center：值为(a, b), 围绕图像中哪个点进行旋转, 默认围绕中心点旋转</p></li>
<li><p>fill: 填充旋转后图像外的内容</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomRotation</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;degrees=(20, 60)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomRotation</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;degrees=60, </span><span class="se">\n</span><span class="s2">expand=True&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomRotation</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;degrees=60, </span><span class="se">\n</span><span class="s2">center=(0, 0)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomRotation</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;degrees=60, </span><span class="se">\n</span><span class="s2">fill=(0, 0, 255)&quot;</span>
    <span class="p">)</span>
    
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3a3a209708a1951d0e6bb608646e51ce84e5a9636133827290d49a56d59e7ff4.png" src="../_images/3a3a209708a1951d0e6bb608646e51ce84e5a9636133827290d49a56d59e7ff4.png" />
</div>
</div>
</section>
<section id="gaussianblur-kernel-size-sigma">
<h3>GaussianBlur(kernel_size[, sigma])<a class="headerlink" href="#gaussianblur-kernel-size-sigma" title="Link to this heading">#</a></h3>
<p>高斯模糊。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">kernel_size</span> <span class="o">=</span><span class="mi">11</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;kernel_size =11&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;kernel_size=(5, 9), </span><span class="se">\n</span><span class="s2">sigma=(0.1, 10)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">kernel_size</span> <span class="o">=</span><span class="mi">99</span><span class="p">,</span><span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;kernel_size =99,</span><span class="se">\n</span><span class="s2">sigma=5&quot;</span>
    <span class="p">)</span>
    
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cbea2b67288799bc5adf2ad515f329e95f54f0a3dff97ba2f31f44a3abbc402f.png" src="../_images/cbea2b67288799bc5adf2ad515f329e95f54f0a3dff97ba2f31f44a3abbc402f.png" />
</div>
</div>
</section>
<section id="fivecrop-size-tencrop-size-vertical-flip-false">
<h3>FiveCrop(size)与 TenCrop(size, vertical_flip=False)<a class="headerlink" href="#fivecrop-size-tencrop-size-vertical-flip-false" title="Link to this heading">#</a></h3>
<p>分别从图像的四个角以及中心进行五次裁剪，最终将返回一个包含5张裁切后图片的tuple。</p>
<ul class="simple">
<li><p>size：裁切尺寸</p>
<ul>
<li><p>当值为(h, w)时，在原始图像四个角以及中心各采取一张h × w的图像</p></li>
<li><p>当值为int时，等同于(size, size)</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">FiveCrop</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">trans_imgs</span> <span class="o">=</span> <span class="n">trans</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;转换后输出变量类型为：</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">trans_imgs</span><span class="p">)</span><span class="si">}</span><span class="s1">, 输出变量长度为：</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">trans_imgs</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span><span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">trans_imgs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;左上角&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">trans_imgs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;右上角&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">trans_imgs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;左下角&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">trans_imgs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;右下角&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">trans_imgs</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;中心&#39;</span><span class="p">),</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>转换后输出变量类型为：&lt;class &#39;tuple&#39;&gt;, 输出变量长度为：5
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 24038 (\N{CJK UNIFIED IDEOGRAPH-5DE6}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 19978 (\N{CJK UNIFIED IDEOGRAPH-4E0A}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 35282 (\N{CJK UNIFIED IDEOGRAPH-89D2}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 21491 (\N{CJK UNIFIED IDEOGRAPH-53F3}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 19979 (\N{CJK UNIFIED IDEOGRAPH-4E0B}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 20013 (\N{CJK UNIFIED IDEOGRAPH-4E2D}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 24515 (\N{CJK UNIFIED IDEOGRAPH-5FC3}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/f10ab3bff79273066f3112330826d2ee5ce6c114fe11513e480786fa62fd876d.png" src="../_images/f10ab3bff79273066f3112330826d2ee5ce6c114fe11513e480786fa62fd876d.png" />
</div>
</div>
<p>再来说TenCrop(size, vertical_flip=False)。</p>
<p>TenCrop(size, vertical_flip=False)就是在FiveCrop(size)的基础上，对原始图像进行水平或者垂直翻转，然后在从翻转后图像的四个角以及中心进行五次裁剪，所以一共获取了10张图像返回。参数vertical_flip默认值为False，表示进行水平翻转，值为True时，表示进行垂直翻转在裁剪。</p>
</section>
<section id="grayscale-num-output-channels-1-randomgrayscale-p-0-1">
<h3>Grayscale(num_output_channels=1) RandomGrayscale(p=0.1)<a class="headerlink" href="#grayscale-num-output-channels-1-randomgrayscale-p-0-1" title="Link to this heading">#</a></h3>
<p>将图像转换为灰度图像，默认通道数为1，通道数为3时，RGB三个通道的值相等。</p>
<ul class="simple">
<li><p>num_output_channels ：指定最终输出图像的通道数，值为1时，最终输出只有一个通道的灰度图像，值为3时，输出三个通到值相等的灰度图像。默认值为1。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">transform1</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Grayscale</span><span class="p">(</span><span class="n">num_output_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">transform2</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Grayscale</span><span class="p">(</span><span class="n">num_output_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">tran_img1</span> <span class="o">=</span> <span class="n">transform1</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="n">tran_img2</span> <span class="o">=</span> <span class="n">transform2</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;num_output_channels=1时，输出为：</span><span class="si">{</span><span class="n">tran_img1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;num_output_channels=3时，输出为：</span><span class="si">{</span><span class="n">tran_img2</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span><span class="n">tran_img1</span><span class="p">,</span> <span class="s1">&#39;num_output_channels=1&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">tran_img2</span><span class="p">,</span> <span class="s1">&#39;num_output_channels=3&#39;</span><span class="p">)</span>
<span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>num_output_channels=1时，输出为：torch.Size([1, 338, 328])
num_output_channels=3时，输出为：torch.Size([3, 338, 328])
</pre></div>
</div>
<img alt="../_images/25bdbeb508a1c7e46f935606c64147dc7ae507def27014c0536893488852fc76.png" src="../_images/25bdbeb508a1c7e46f935606c64147dc7ae507def27014c0536893488852fc76.png" />
</div>
</div>
<p>RandomGrayscale以一定的概率将图像变为灰度图像。实际上就是以一定的概率执行torchvision.transforms.Grayscale。参数只有一个概率值p，默认值为0.1。这里不再演示。</p>
</section>
<section id="randomsolarize-threshold-p-0-5">
<h3>RandomSolarize(threshold, p=0.5)<a class="headerlink" href="#randomsolarize-threshold-p-0-5" title="Link to this heading">#</a></h3>
<p>以一定概率将超过给定阈值的像素值进行反转。</p>
<ul class="simple">
<li><p>threshold：反转像素阈值</p></li>
<li><p>p: 概率值</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomSolarize</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;threshold=60, p=1&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomSolarize</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;threshold=150, p=1&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomSolarize</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;threshold=200, p=1&quot;</span>
    <span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/310ec0eea0e6007c263eba529a38072aef7c003df71e535270457e5fd220990e.png" src="../_images/310ec0eea0e6007c263eba529a38072aef7c003df71e535270457e5fd220990e.png" />
</div>
</div>
</section>
<section id="randomaffine-degrees-translate-none-scale-none-shear-none-resample-false-fillcolor-0">
<h3>RandomAffine(degrees, translate=None, scale=None, shear=None, resample=False, fillcolor=0)<a class="headerlink" href="#randomaffine-degrees-translate-none-scale-none-shear-none-resample-false-fillcolor-0" title="Link to this heading">#</a></h3>
<p>RandomAffine的作用是保持图像中心不变的情况下对图像进行随机的仿射变换。</p>
<ul class="simple">
<li><p>degrees：度数范围。</p>
<ul>
<li><p>值为（min，max）时，表示在（min，max）之间随机变换角度</p></li>
<li><p>值为int时，等同于（-degrees，degrees）</p></li>
</ul>
</li>
<li><p>translate：位移距离。值为tuple类型，例如translate=（a，b），则在范围[-图像宽度 × a, 图像宽度 × a]中随机采样水平移位，在范围[-图像高度 × b, 图像高度 × b]中随机采样垂直移位。默认值为0，表示不进行位移。</p></li>
<li><p>scale：缩放。值为tuple类型，例如translate=（a，b），表示在[a, b]范围内随机采样进行缩放，默认情况下将保持原始比例。</p></li>
<li><p>shear:可从中选择的度数范围。仿射变换的角度。</p></li>
<li><p>interpolation：插值的方法。</p></li>
<li><p>fill:填充像素的值。默认为0.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">60</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;degrees=60&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;translate=(0.2, 0.6)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;scale=(0.4, 0.8)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="mi">60</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;shear=60&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;shear=(30, 80)&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;degrees=80,</span><span class="se">\n</span><span class="s2">fill=(0, 255, 255)&quot;</span>
    <span class="p">),</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/76403866424294a36527646cbc41c38bee2b8e81f23d802e979865221c9b32bc.png" src="../_images/76403866424294a36527646cbc41c38bee2b8e81f23d802e979865221c9b32bc.png" />
</div>
</div>
</section>
<section id="randomcrop-size-padding-none-pad-if-needed-false-fill-0-padding-mode-constant">
<h3>RandomCrop(size, padding=None, pad_if_needed=False, fill=0, padding_mode=’constant’)<a class="headerlink" href="#randomcrop-size-padding-none-pad-if-needed-false-fill-0-padding-mode-constant" title="Link to this heading">#</a></h3>
<p>在一个随机位置上对图像进行裁剪。</p>
<ul class="simple">
<li><p>size：裁切保留多少个像素</p>
<ul>
<li><p>值为tuple，例如(h, w)，表示裁切尺寸为(h, w)</p></li>
<li><p>值为int，等同于(size, size)</p></li>
</ul>
</li>
<li><p>padding：填充边框像素值</p>
<ul>
<li><p>如果是整型，表示对4个边框都填充padding个像素值</p></li>
<li><p>如果是长度为2的序列，例如，padding=(5, 10)，表示对左右边框填充5个像素值，上下边框填充10个像素值。</p></li>
<li><p>如果是长度为4的序列，例如，padding=(5, 10, 15, 20)，表示对左、上、右、下分别填充5、10、15、20个像素值。</p></li>
</ul>
</li>
<li><p>pad_if_needed：如果图像小于所需大小，它将先填充图像然后进行裁切以避免引发异常。由于裁剪是在填充之后完成的，所以填充似乎是以随机偏移量完成的。</p></li>
<li><p>fill：填充的内容，默认值为0</p></li>
<li><p>padding_mode：填充模式，即以什么内容填充。默认为值’constant’</p>
<ul>
<li><p>constant：常量填充，填充的内容由fill参数指定。</p></li>
<li><p>edge：用原始图像的最后一个像素值填充。</p></li>
<li><p>reflect：在边缘上不重复最后一个值的情况下，使用图像反射进行填充。例如，图像某一行像素为[1，2，3，4]，左右两边充填两个像素，因为不重复边界像素，左侧的像素值1和右侧的像素值4不进行反射，左侧就法则2和3，发射后成了3和2，填充到图像左侧，右侧反射2和3，反射后成了3和2，填充到图像右侧，最终这一行像素值变成[3，2，1，2，4，3，2]。</p></li>
<li><p>symmetric：就是reflect方式填充，只不过重复边界像素值。[1，2，3，4]使用这种方式填充后为[2, 1, 1, 2, 3, 4, 4, 3]。</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;size=200&quot;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">padding</span><span class="o">=</span><span class="mi">200</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;size=500,padding=200&quot;</span>
    <span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/35a19713bbf93fe2f878561f8e529e3db034d68ec8f91cad4d33ec7430fb797d.png" src="../_images/35a19713bbf93fe2f878561f8e529e3db034d68ec8f91cad4d33ec7430fb797d.png" />
</div>
</div>
</section>
<section id="randomhorizontalflip-p-0-5-randomverticalflip-p-0-5">
<h3>RandomHorizontalFlip(p=0.5)与RandomVerticalFlip(p=0.5)<a class="headerlink" href="#randomhorizontalflip-p-0-5-randomverticalflip-p-0-5" title="Link to this heading">#</a></h3>
<p>以一定的概率将图像水平翻转。参数只有一个概率值p，默认值为0.5。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;水平翻转&quot;</span>
    <span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 27700 (\N{CJK UNIFIED IDEOGRAPH-6C34}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 24179 (\N{CJK UNIFIED IDEOGRAPH-5E73}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 32763 (\N{CJK UNIFIED IDEOGRAPH-7FFB}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/c776f98681572a1856811db74819c44cb364f3850c3b79b9bbc1875d95a2c5db.png" src="../_images/c776f98681572a1856811db74819c44cb364f3850c3b79b9bbc1875d95a2c5db.png" />
</div>
</div>
<p>有水平翻转，就有垂直翻转，即RandomVerticalFlip(p=0.5)，用法与RandomHorizontalFlip(p=0.5)完全一致，这里不再介绍。</p>
</section>
<section id="randomperspective-distortion-scale-0-5-p-0-5-interpolation-3-fill-0">
<h3>RandomPerspective(distortion_scale=0.5, p=0.5, interpolation=3, fill=0)<a class="headerlink" href="#randomperspective-distortion-scale-0-5-p-0-5-interpolation-3-fill-0" title="Link to this heading">#</a></h3>
<p>以一定的概率对图像进行随机的透视变换。</p>
<ul class="simple">
<li><p>distortion_scale：扭曲的角度，取值在[0, 1]之间，默认值为0.5.</p></li>
<li><p>p：执行变换的概率。</p></li>
<li><p>interpolation：插值的方法。</p></li>
<li><p>fill：填充的内容，默认值为0。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomPerspective</span><span class="p">(</span><span class="n">distortion_scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;distortion_scale=0.5&quot;</span>
    <span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d6ca70e61001ab3f3e9b25c39f5b7ba6ad343caad4083c634771b7f0e8c5092c.png" src="../_images/d6ca70e61001ab3f3e9b25c39f5b7ba6ad343caad4083c634771b7f0e8c5092c.png" />
</div>
</div>
</section>
<section id="randomequalize-p-0-5">
<h3>RandomEqualize(p=0.5)<a class="headerlink" href="#randomequalize-p-0-5" title="Link to this heading">#</a></h3>
<p>以一定的概率均衡图像色调直方图。</p>
<ul class="simple">
<li><p>p：执行变换的概率。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomEqualize</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;threshold=60, p=1&quot;</span>
    <span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/85312f6e34255f8f8d16ac69a4762b480aaebf4170963fa404485a3323fa56ce.png" src="../_images/85312f6e34255f8f8d16ac69a4762b480aaebf4170963fa404485a3323fa56ce.png" />
</div>
</div>
</section>
<section id="randomapply-p-0-5">
<h3>RandomApply(p=0.5)<a class="headerlink" href="#randomapply-p-0-5" title="Link to this heading">#</a></h3>
<p>以一定的概率执行一组图像变换API，要么全部执行，要么全不执行。</p>
<ul class="simple">
<li><p>p：执行变换的概率。</p></li>
</ul>
</section>
</section>
<section id="pil-imageapi">
<h2>专用于PIL.Image的图像变换API<a class="headerlink" href="#pil-imageapi" title="Link to this heading">#</a></h2>
<p>这种类型的API只有两个：RandomChoice和RandomOrder，官方文档指出，此类API只适用于PIL.Image类型图像。</p>
<section id="randomchoice-transforms-p">
<h3>RandomChoice(transforms[, p])<a class="headerlink" href="#randomchoice-transforms-p" title="Link to this heading">#</a></h3>
<p>以一定的概率从多个图像变换API中选取一个对图像进行变换，注意：可能一个都不选取，即不执行变换。</p>
<ul class="simple">
<li><p>transforms：多个图像变换API组成的序列</p></li>
<li><p>p：执行变换的概率。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>

<span class="n">trans</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">RandomChoice</span><span class="p">([</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="mi">350</span><span class="p">),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">RandomEqualize</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">RandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">trans</span><span class="p">(</span><span class="n">raw_img</span><span class="p">),</span> <span class="s1">&#39;随机一次变换&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">trans</span><span class="p">(</span><span class="n">raw_img</span><span class="p">),</span> <span class="s1">&#39;随机一次变换&#39;</span>
    <span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 19968 (\N{CJK UNIFIED IDEOGRAPH-4E00}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 27425 (\N{CJK UNIFIED IDEOGRAPH-6B21}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/9e27db43cd62257315eef93908d6615528da5cd2f0a83cb8831781f01125529f.png" src="../_images/9e27db43cd62257315eef93908d6615528da5cd2f0a83cb8831781f01125529f.png" />
</div>
</div>
</section>
<section id="randomorder-transforms-p">
<h3>RandomOrder(transforms[, p])<a class="headerlink" href="#randomorder-transforms-p" title="Link to this heading">#</a></h3>
<p>以随机顺序执行给定的多个图像变换API。</p>
<ul class="simple">
<li><p>transforms：多个图像变换API组成的序列</p></li>
</ul>
<p>从功能上说，这两个API都不是专门针对PIL.Image，我不知道官方文档上为什么这么分类。</p>
</section>
</section>
<section id="torch-tensorapi">
<h2>专用于torch.*Tensor的图像变换API<a class="headerlink" href="#torch-tensorapi" title="Link to this heading">#</a></h2>
<section id="lineartransformation-transformation-matrix">
<h3>LinearTransformation(transformation_matrix, …)<a class="headerlink" href="#lineartransformation-transformation-matrix" title="Link to this heading">#</a></h3>
<p>使用变换矩阵和离线计算的均值向量对图像张量进行变换，可以用在白化变换中，白化变换用来去除输入数据的冗余信息。常用在数据预处理中。</p>
</section>
<section id="normalize-mean-std-inplace-false">
<h3>Normalize(mean, std, inplace=False)<a class="headerlink" href="#normalize-mean-std-inplace-false" title="Link to this heading">#</a></h3>
<p>逐channel的对图像进行标准化（均值变为0，标准差变为1），可以加快模型的收敛</p>
</section>
<section id="randomerasing-p-0-5-scale-0-02-0-33-ratio-0-3-3-3">
<h3>RandomErasing(p=0.5, scale=(0.02, 0.33), ratio=(0.3, 3.3)<a class="headerlink" href="#randomerasing-p-0-5-scale-0-02-0-33-ratio-0-3-3-3" title="Link to this heading">#</a></h3>
<p>随机选择图像中的一块区域，擦除其像素，主要用来进行数据增强。</p>
<ul class="simple">
<li><p>p: 执行擦除的概率。</p></li>
<li><p>scale：擦除区域相对于输入图像的比例范围。</p></li>
<li><p>ratio：擦除区域的纵横比范围。</p></li>
<li><p>value：擦除区域的填充内容。</p></li>
<li><p>inplace：是否原地修改，默认为False。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">([</span>
    <span class="p">(</span>
        <span class="n">raw_img</span><span class="p">,</span> <span class="s1">&#39;原始图像&#39;</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="n">transforms</span><span class="o">.</span><span class="n">RandomErasing</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span><span class="n">ratio</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span><span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))(</span><span class="n">raw_img</span><span class="p">),</span>
        <span class="s2">&quot;随机擦除&quot;</span>
    <span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 25830 (\N{CJK UNIFIED IDEOGRAPH-64E6}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
/Users/ascotbe/anaconda3/lib/python3.10/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 38500 (\N{CJK UNIFIED IDEOGRAPH-9664}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../_images/234b416ead5e40dbabe72f3ab5ea990883707b245546de171de729133782c60b.png" src="../_images/234b416ead5e40dbabe72f3ab5ea990883707b245546de171de729133782c60b.png" />
</div>
</div>
</section>
<section id="id5">
<h3>RandomErasing(p=0.5, scale=(0.02, 0.33), ratio=(0.3, 3.3)<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>对图像中各像素数据类型进行转换。</p>
<ul class="simple">
<li><p>dtype : 输出图像中各个像素的数据类型</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;转换前数据类型为：</span><span class="si">{</span><span class="n">raw_img</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>转换前数据类型为：torch.uint8
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ConvertImageDtype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)(</span><span class="n">raw_img</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;转换前数据类型后：</span><span class="si">{</span><span class="n">img</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>转换前数据类型后：torch.float32
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id6">
<h2>转换类型的图像变换API<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<section id="topilimage-mode">
<h3>ToPILImage([mode])<a class="headerlink" href="#topilimage-mode" title="Link to this heading">#</a></h3>
<p>将torch.Tensor或numpy.ndarray类型图像转为PIL.Image类型图像。</p>
<ul class="simple">
<li><p>mode: PIL.Image模式</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;转换前图像类型为：</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ToPILImage</span><span class="p">()(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;转换后图像类型为：</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>转换前图像类型为：&lt;class &#39;torch.Tensor&#39;&gt;
转换后图像类型为：&lt;class &#39;PIL.Image.Image&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="totensor">
<h3>ToTensor()<a class="headerlink" href="#totensor" title="Link to this heading">#</a></h3>
<p>将PIL.Image或numpy.ndarray类型图像转为torch.Tensor类型图像。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;转换前图像类型为：</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;转换后图像类型为：</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>转换前图像类型为：&lt;class &#39;PIL.JpegImagePlugin.JpegImageFile&#39;&gt;
转换后图像类型为：&lt;class &#39;torch.Tensor&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="piltotensor">
<h3>PILToTensor()<a class="headerlink" href="#piltotensor" title="Link to this heading">#</a></h3>
<p>将PIL.Image(shape为：(H x W x C))类型图像转为torch.Tensor(shape为： (C x H x W))。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;../raw/sticker.jpeg&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;转换前图像类型为：</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">raw_img</span><span class="p">)</span><span class="si">}</span><span class="s1">，&#39;</span><span class="p">)</span> 

<span class="n">img</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()(</span><span class="n">raw_img</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;转换后图像类型为：</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>转换前图像类型为：&lt;class &#39;PIL.JpegImagePlugin.JpegImageFile&#39;&gt;，
转换后图像类型为：&lt;class &#39;torch.Tensor&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./PrerequisiteKnowledge"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="%E5%85%B3%E4%BA%8Etensor%E4%B8%AD%E7%9A%84is_leaf.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">关于tensor中的is_leaf</p>
      </div>
    </a>
    <a class="right-next"
       href="../FunctionDetails/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">函数详解</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PyTorch图像处理</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">导入所需的库</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">加载图片</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pil">PIL库</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">pytorch中提供的图像加载方法</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#transforms">transforms</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compose">Compose</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">自定义图像变换</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pytorchapi">pytorch中开箱即用的图像变换API</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api">通用型图像变换API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#centercrop-size">CenterCrop(size)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resize-size">Resize(size)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pad-padding-fill-0-padding-mode-constant">Pad(padding, fill=0, padding_mode=’constant’)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colorjitter-brightness-0-contrast-0-saturation-0-hue-0">ColorJitter(brightness=0, contrast=0, saturation=0, hue=0)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomrotation-degrees-interpolation">RandomRotation(degrees[, interpolation, …])</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussianblur-kernel-size-sigma">GaussianBlur(kernel_size[, sigma])</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fivecrop-size-tencrop-size-vertical-flip-false">FiveCrop(size)与 TenCrop(size, vertical_flip=False)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grayscale-num-output-channels-1-randomgrayscale-p-0-1">Grayscale(num_output_channels=1) RandomGrayscale(p=0.1)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomsolarize-threshold-p-0-5">RandomSolarize(threshold, p=0.5)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomaffine-degrees-translate-none-scale-none-shear-none-resample-false-fillcolor-0">RandomAffine(degrees, translate=None, scale=None, shear=None, resample=False, fillcolor=0)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomcrop-size-padding-none-pad-if-needed-false-fill-0-padding-mode-constant">RandomCrop(size, padding=None, pad_if_needed=False, fill=0, padding_mode=’constant’)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomhorizontalflip-p-0-5-randomverticalflip-p-0-5">RandomHorizontalFlip(p=0.5)与RandomVerticalFlip(p=0.5)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomperspective-distortion-scale-0-5-p-0-5-interpolation-3-fill-0">RandomPerspective(distortion_scale=0.5, p=0.5, interpolation=3, fill=0)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomequalize-p-0-5">RandomEqualize(p=0.5)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomapply-p-0-5">RandomApply(p=0.5)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pil-imageapi">专用于PIL.Image的图像变换API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomchoice-transforms-p">RandomChoice(transforms[, p])</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomorder-transforms-p">RandomOrder(transforms[, p])</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#torch-tensorapi">专用于torch.*Tensor的图像变换API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lineartransformation-transformation-matrix">LinearTransformation(transformation_matrix, …)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-mean-std-inplace-false">Normalize(mean, std, inplace=False)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#randomerasing-p-0-5-scale-0-02-0-33-ratio-0-3-3-3">RandomErasing(p=0.5, scale=(0.02, 0.33), ratio=(0.3, 3.3)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">RandomErasing(p=0.5, scale=(0.02, 0.33), ratio=(0.3, 3.3)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">转换类型的图像变换API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topilimage-mode">ToPILImage([mode])</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#totensor">ToTensor()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#piltotensor">PILToTensor()</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ascotbe
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>